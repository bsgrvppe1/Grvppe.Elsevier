USE [PPM_TO_NAVISION]
GO


IF EXISTS (SELECT name FROM sysobjects WHERE name = 'spr_SelectAuthorToNAV' AND type = 'P')
   DROP PROCEDURE spr_SelectAuthorToNAV 
GO


CREATE PROCEDURE spr_SelectAuthorToNAV

AS BEGIN

	SELECT
		 HOLDERS.[EAN_CODE]							AS 'EAN_CODE'
		,HOLDERS.[ORDER_NO]							AS 'ORDER_NO'
		,HOLDERS.[SORT_NO]							AS 'SORT_NO'
		,SUBSTRING(HOLDERS.[FIRST_NAME], 1, 250)	AS 'FIRST_NAME'
		,SUBSTRING(HOLDERS.[NAME], 1, 250)			AS 'LAST_NAME'
		,ISNULL(HOLDERS.[FROM_IMPRESSION_NO], 0)	AS 'EDITION'
    FROM [COPYRIGHT_HOLDER] AS HOLDERS
	WHERE HOLDERS.[REC_STATUS] = 'I'
	AND ( (HOLDERS.EAN_CODE <> '') OR (HOLDERS.ORDER_NO <> '') )

END
